# 长治三毛业务数据采集展示平台 — 需求文档（最新版）

> 更新日期：2025-11-20 23:40

## 1. 项目概述
构建一套支持 PC 与移动端的 **数据采集与展示平台**，通过后端代理解决跨域，对接两个外部 HTTP 接口，实现登录、数据中台、采集展示三大页面，界面美观、现代化。

---

## 2. 页面与核心流程

| 页面 | 入口 | 核心功能 |
| ---- | ---- | -------- |
| ① 登录页 | `/` | 账号密码登录（默认 admin / 123456） |
| ② 数据中台 | `/center.html` | 点击“获取业务数据”→ 调用接口 → 跳转展示页 |
| ③ 采集展示 | `/display.html` | 显示 B1/N1/M1/C1 及原始 JSON、Data 表格 |

---

## 3. 接口与变量规则

### ① 获取 TimeKay
- **地址**：`GET http://inter.bak365.cn/Service.ashx?Type=GetTimeKay`
- **后端代理**：`/api/timekay`
- **判断**：返回 `State===true` 时取 `Data.TimeKay` 作为 **B1**，否则终止并提示原始返回。

### ② 获取业务数据
- **地址**：`POST http://inter.bak365.cn/Service.ashx?AppNo=Test&Type=CardInfo&MAC={M1}`
- **后端代理**：`/api/cardinfo`
- **变量生成**：
  - N1 = `Test123456{"CardNo":"0001"}{B1}`
  - M1 = `MD5(N1)`
  - C1 = 上述地址（MAC 替换为 M1）
- **POST 体**：`{"CardNo":"0001"}`

---

## 4. 页面详细要求

### 4.1 登录页
- 标题：长治三毛业务对接平台
- 默认账号/密码：admin / 123456
- 记住密码复选框与文字左对齐，点击文字可切换勾选
- 插画为后端动态 SVG，无文字，保持现代风格

### 4.2 数据中台页
- 标题：长治三毛业务数据中台
- 顶部卡片与操作卡片宽度一致（90%），圆角+阴影
- **操作区按钮**（垂直居中，宽度 200px，悬停上浮+阴影）：
  1. 获取业务数据（primary）
  2. 原材料入库（secondary）
  3. 生产领料出库（secondary）
  4. 产成品入库（secondary）
  5. 销售出口(调拨)（secondary）
  6. 销售出口(配送)（secondary）
- 错误提示采用浅红卡片，清晰不刺眼
- 顶部仅保留“退出”按钮，已移除“返回登录”

### 4.3 采集展示页
- 标题：长治三毛业务数据采集展示
- 四行关键信息 + 空行 + 提示文字 + 原始 JSON + Data 表格
- 容器宽度 95%，最大 1400px，顶部内边距 12px，整体靠上
- 表格 13 列，横向空间充裕，减少换行

---

## 5. 技术实现要点
- **后端**：Node.js 原生 http，统一 CORS，代理转发，MD5 计算
- **前端**：原生 HTML/CSS/JS，无框架，fetch，sessionStorage 跨页传值
- **样式**：Tailwind-like 自定义变量，圆角、阴影、响应式
- **图标**：lucide-react（SVG 内联）

---

## 6. 最新变更记录（倒序）
| 时间 | 变更内容 |
| ---- | -------- |
| 最新 | 数据中台新增 5 个业务按钮，宽度 200px，悬停动效统一 |
| 最新 | 移除数据中台“返回登录”按钮，仅保留顶部“退出” |
| 最新 | 登录页标题改为“长治三毛业务对接平台” |
| 最新 | 记住密码复选框与文字左对齐，点击文字可切换 |
| 最新 | 第三页顶部内边距减至 12px，整体靠上 |
| 最新 | 第三页容器宽度 95% / 1400px，减少换行 |
| 最新 | 第三页第四行后插入空行与提示文字 |
| 前续 | 第二页卡片现代化，统一宽度与阴影 |
| 前续 | 登录插画后端动态生成，无文字 |
| 前续 | 登录页响应式修复，媒体查询语法修正 |

---

## 7. 运行与验证
```bash
node server.js
# 访问 http://localhost:3000
```
- 登录 → 获取业务数据 → 查看采集结果
- 检查控制台无报错，接口返回正常，样式无错位

---

> 文档随代码实时更新，最新状态以本文件为准。