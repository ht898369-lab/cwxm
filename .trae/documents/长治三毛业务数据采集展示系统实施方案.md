## 项目概述
- 目标：构建支持 PC 与移动端的数据采集与展示应用，聚合两个上游 HTTP 接口并在后端统一解决跨域。
- 页面：共 3 个页面
  - 登录页（标题含“长治三毛业务管理”）
  - 数据中台页（标题“长治三毛业务数据中台”）
  - 采集展示页（标题“长治三毛业务数据采集展示”）
- 关键变量：`B1`（TimeKay）、`N1`（拼接串）、`M1`（MD5）、`C1`（二次调用地址）

## 技术栈与架构
- 后端：Node.js（原生 `http` 模块实现路由与 CORS；如需数据库使用 `mysql2` 可选）
- 前端：原生 HTML/CSS/JS，统一响应式（移动优先），使用 `fetch` 调用后端路由
- 跨域：后端统一代理上游接口，设置 CORS 头，前端仅访问同源后端 API
- 部署：`node server.js` 即可启动；静态资源由后端路由直接提供

## 上游接口协议
- 获取时间键（地址一）
  - 方法：`GET`
  - URL：`http://inter.bak365.cn/Service.ashx?Type=GetTimeKay`
  - 期望返回（示例）：`{"State":true,"Msg":"","Data":{"TimeKay":"3611712"}}`
- 获取卡信息（地址二）
  - 方法：`POST`
  - URL 模板：`http://inter.bak365.cn/Service.ashx?AppNo=Test&Type=CardInfo&MAC=<M1>`
  - 请求体：`{"CardNo":"0001"}`（JSON）
  - 期望返回（示例失败）：`{"State":false,"Msg":"验证失败","Data":{}}`

## 变量与拼接规则
- `B1`：当地址一返回 `State===true` 时，取 `Data.TimeKay`
- `N1`：将 `"Test"`、`"123456"`、`{"CardNo":"0001"}` 的 JSON 字符串、`B1` 依次拼接为一个字符串（无分隔符）
- `M1`：对 `N1` 进行 MD5，取 32 位小写十六进制摘要
- `C1`：将地址二中的 `MAC=mac` 替换为 `MAC=<M1>` 后的完整 URL

## 后端路由与跨域处理
- 统一 CORS 头：`Access-Control-Allow-Origin: *`；`Access-Control-Allow-Headers: Content-Type, Authorization`；`Access-Control-Allow-Methods: GET,POST,DELETE,OPTIONS`
- 路由设计（前端只调这些）
  - `GET /api/timekay`：代理调用地址一
    - 逻辑：请求上游；若 `State===true`，返回 `{State:true,B1,raw}`；否则返回 `{State:false,raw}` 并置错误码
  - `POST /api/cardinfo`：生成 `N1/M1/C1` 并代理调用地址二
    - 入参：`{ B1?:string }`（也可后端自行读取上一步缓存或前端传递）
    - 逻辑：当 `B1` 非空时，构造 `N1/M1/C1`，以 JSON 体 `{"CardNo":"0001"}` 调用 `C1`；返回 `{B1,N1,M1,C1,resp}`
- 安全与健壮性
  - 严格校验 `B1` 存在与格式；所有外部调用增加超时（如 8s）与错误捕获
  - 禁止在日志中输出敏感串 `N1/M1`，仅在页面展示时按需显示

## 页面设计与交互
- 登录页（PC+移动优先）
  - 标题与品牌：在居中卡片顶部显示“长治三毛业务管理”；现代化主题（深浅色适配）
  - 表单：账户（默认 `admin`）、密码（默认 `123456`）；显示占位与记住我；支持回车登录
  - 行为：点击“登录”后校验并调用后端 `POST /api/login`（固定校验），成功后跳转“数据中台页”
  - 退出：无（为入口页）
- 数据中台页
  - 标题：居中显示“长治三毛业务数据中台”
  - 主按钮：“获取业务数据”
  - 行为：
    - 点击后调用 `GET /api/timekay`
    - 若返回 `State!==true`：在页面底部以红色提示完整返回字符串，终止后续流程
    - 若 `State===true`：取出 `B1`，随后向 `POST /api/cardinfo` 发送请求（入参携带 `B1` 或由后端缓存），收到响应后把 `{B1,N1,M1,C1,resp}` 写入 `sessionStorage`，跳转“采集展示页”
  - 退出：右上角“退出”按钮返回“登录页”
- 采集展示页
  - 标题：居中显示“长治三毛业务数据采集展示”
  - 中间区域四行文本：
    - 第一行：`TimeKay:` 后显示 `B1`，并显示 `1分钟内有效`
    - 第二行：`MAC:` 后显示 `M1`
    - 第三行：`调用地址:` 后显示 `C1`
    - 第四行：`拼接串:` 后显示 `N1`
  - 数据展示：在第四行下方用代码块或等宽字体展示 `resp` 原始 JSON 文本，同时可额外把 `resp.Data` 结构化为表格（若有）
  - 返回：底部“返回数据中台”跳回第二页；右上角“退出”返回“登录页”

## 响应式与美观要求
- 布局：移动端单列卡片 + PC 端居中宽卡片；栅格与 Flex 结合
- 主题：现代化配色、圆角、阴影、流畅动效；系统字体；高对比度与可访问性
- 适配：`<meta viewport>`，断点：`≤600px` 移动样式；`>600px` 桌面样式

## 时序流程（关键路径）
1. 登录页：输入 `admin/123456` → `POST /api/login` → 成功 → 跳转数据中台页
2. 数据中台页：点击“获取业务数据” → `GET /api/timekay`
   - 若 `State!==true`：显示错误原文 → 停止
   - 若 `State===true`：得到 `B1` → `POST /api/cardinfo`（后端构造 `N1/M1/C1` 并代理）→ 将 `{B1,N1,M1,C1,resp}` 保存 → 跳转采集展示页
3. 采集展示页：读取保存的数据 → 展示四行文本与 JSON → 可返回第二页或退出到登录页

## 错误处理与边界
- 网络异常：统一 toast/错误区提示；按钮在请求中禁用，支持重试
- 数据异常：当地址一 `State!==true`，显示完整 JSON 字符串并终止流程
- 超时：接口设定超时与重试策略；提示用户检查网络
- 一致性：`B1` 一次获取，1 分钟内有效；超过有效期提示重新获取

## 数据安全与存储
- 前端仅暂存 `{B1,N1,M1,C1,resp}` 于 `sessionStorage`，刷新后需重新获取
- 后端不长久存储上游数据；日志脱敏；禁止输出明文密码

## 交付物与验收标准
- 3 个页面（登录/中台/展示）满足文案与交互细节
- 后端 2 条代理路由可稳定访问上游并正确拼接与计算 MD5
- 跨域在后端解决，前端同源调用无浏览器 CORS 报错
- 移动端与桌面端均视觉美观、布局整齐、交互顺畅
- 提供本地启动与验证步骤说明

## 实现步骤（确认后执行）
1. 后端：补全/对齐路由 `GET /api/timekay` 与 `POST /api/cardinfo`，统一 CORS 与错误处理，封装 MD5 计算
2. 前端：
   - 登录页：美化卡片与品牌文案，调用登录接口并跳转
   - 数据中台页：实现按钮与状态文案、错误区、与路由交互
   - 采集展示页：四行文本区 + JSON 展示 + 返回与退出
   - 样式：响应式断点、统一主题与组件化样式（按钮/卡片/标题）
3. 联调与验证：本地启动 → 按时序完整跑通 → 记录示例返回与截图

请确认以上方案；确认后我将按此方案直接生成并对接页面与后端路由。